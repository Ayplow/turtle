language: rust
os:
  - linux
  - osx
rust:
  - stable
  - beta
  - nightly
script:
  - cargo build --verbose --all
  - cargo run --verbose --example runtest
  - cargo test --verbose --features "test" --all
  - cargo doc --verbose --all
# We are using xvfb to run our runtest which uses GUI
# https://docs.travis-ci.com/user/gui-and-headless-browsers/#Using-xvfb-to-Run-Tests-That-Require-a-GUI
before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start
matrix:
  # Mark the build as finished even if the allow_failures builds
  # are still running
  fast_finish: true
  allow_failures:
    - rust: beta
    - rust: nightly
